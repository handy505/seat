# 座位表最佳化 - 使用基因演算法
## 執行
```
handy@dell ~/seat_tables $ python3 ga.py 
#11,153,0 #15,161,0 #39,150,0 #34,165,0 #24,160,0 #05,151,0 #35,152,0
#16,156,0 #30,156,0 #37,160,0 #12,158,0 #14,155,0 #17,154,0 #33,159,0
#19,160,0 #03,156,0 #29,153,0 #21,149,0 #08,162,0 #25,149,0 #23,162,0
#38,149,0 #04,150,0 #02,159,0 #09,164,0 #10,165,0 #06,165,0 #22,164,0
#32,153,0 #40,164,0 #36,162,0 #27,160,0 #20,162,0 #28,160,0 #--,---,-
#31,158,0 #13,165,0 #--,---,- #01,159,0 #07,165,0 #26,160,0 #18,164,0
score: 154
#35,152,0 #16,156,0 #30,156,0 #31,158,0 #08,162,0 #05,151,0 #29,153,0
#15,161,0 #12,158,0 #21,149,0 #32,153,0 #25,149,0 #--,---,- #10,165,0
#37,160,0 #14,155,0 #34,165,0 #19,160,0 #27,160,0 #02,159,0 #03,156,0
#24,160,0 #23,162,0 #33,159,0 #04,150,0 #22,164,0 #39,150,0 #38,149,0
#28,160,0 #20,162,0 #01,159,0 #40,164,0 #36,162,0 #07,165,0 #09,164,0
#13,165,0 #17,154,0 #06,165,0 #11,153,0 #--,---,- #26,160,0 #18,164,0
score: 168
(skip...)
```
## 概念：達爾文 物競天擇
0.由於競爭/淘汰的關系，相信群體會往適應環境的方向演化。適應函數如何設計，決定了演化的方向。  
1.輸入學生資料做為設定檔，格式：座號,姓名,身高,擔任幹部(有填1，無填0)  
2.基因演算法  
2.1.染色體：座位表  
2.2.適應函數：座位在愈後方，身高應愈高。每張座位表會得到一個分數，在此的定義，分數愈高表示愈差，競爭力愈低。  
2.3.選擇、複製：使用輪盤法選擇，分數愈低，被選上的機率愈高。選出一對，然後交配。  
2.4.突變：單一座位表內，任選兩學生，座位對調。(可調整突變率)  

## 技巧
1.物件導向，將細節隱藏於物件內。三大類別：學生/座位表/基因演算法。  
2.使用numpy簡化二維陣列的操作, numpy陣列只放座號。  
3.使用字典做為座號與學生資料的對映。  
4.使用工廠模式建立學生字典。  
5.在填充座位表時，先將二維陣列平面化，再做後續處理，會大幅提高可讀性。  
6.使用輪盤法的機率選擇時，由於分數與競爭力成反比，(分數高競爭力低)，處理上先將分數倒數，再做機率處理。  
7.輪盤法使用cdf+bisect技巧實做。  

## 未實做
1.適應函數：希望座位表內每行有一個擔任幹部的學生。  
2.適應函數：希望某些特定的學生不要坐在一起。  

## 參考
[基因演算法](https://dotblogs.com.tw/dragon229/2013/01/03/86692)  
[Pythonic way to select list elements with different probability](https://stackoverflow.com/questions/4113307/pythonic-way-to-select-list-elements-with-different-probability)  
